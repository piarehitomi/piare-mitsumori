<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>株式会社ピアレキタガワ 見積書作成（印刷基準版 v7.3.1R PrintPro）</title>

<!-- フォント（オフラインでも代替フォントで表示可能） -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic:wght@400;700&display=swap" rel="stylesheet">

<style>
  :root{
    --ink:#111;
    --muted:#666;
    --line:#ddd;
  }
  *{box-sizing:border-box;}
  html,body{height:100%;}
  body{
    font-family:"BIZ UDPGothic", system-ui, -apple-system, "Hiragino Kaku Gothic ProN","Yu Gothic", Meiryo, sans-serif;
    color:var(--ink);
    margin:0; background:#fff;
  }
  .sheet{
    width:210mm; min-height:297mm; padding:14mm 16mm;
    margin:0 auto;
  }
  header{
    display:flex; justify-content:space-between; align-items:flex-start;
    gap:12mm; margin-bottom:8mm;
  }
  /* 左＝宛名ブロック（住所→氏名様→TEL） */
  .to-block{
    flex:1 1 auto;
  }
  .to-label{font-size:12px; color:var(--muted); margin-bottom:2mm;}
  .to-address{
    font-size:12.5px; line-height:1.5; white-space:pre-wrap; margin-bottom:2mm;
  }
  .to-name-line{
    display:flex; align-items:baseline; gap:3mm; margin-bottom:2mm;
  }
  .to-name{
    font-weight:700; font-size:19px; letter-spacing:0.02em;
  }
  .sama{font-size:16px; font-weight:700;}
  .to-tel{font-size:12.5px; color:#222;}

  /* 右＝会社情報（右寄せ／ロゴ 上／QR 下） */
  .from-block{
    flex:0 0 72mm; text-align:right;
  }
  .logo{
    width:26mm; height:12mm; border:1px solid var(--line);
    display:inline-flex; align-items:center; justify-content:center;
    font-size:11px; color:var(--muted); margin:0 0 3mm auto;
  }
  .company{
    font-size:12px; line-height:1.5; white-space:pre-line; margin-bottom:4mm;
  }
  .qr{
    width:26mm; height:26mm; border:1px solid var(--line);
    display:inline-flex; align-items:center; justify-content:center;
    font-size:11px; color:var(--muted); margin-left:auto;
  }

  /* タイトル */
  .title{
    text-align:left; font-size:22px; font-weight:700;
    margin:6mm 0 4mm 0; padding-bottom:2mm; border-bottom:2px solid var(--ink);
    letter-spacing:0.02em;
  }

  /* 明細テーブル */
  table{
    width:100%; border-collapse:collapse;
  }
  th, td{
    border:1px solid var(--line); padding:6px 8px; vertical-align:middle;
    font-size:12.5px;
  }
  th{background:#fafafa; text-align:center; font-weight:700;}
  td.right{text-align:right;}
  td.center{text-align:center;}
  .unit-badge{font-size:11px; color:var(--muted); margin-left:2px;}
  .section-title{
    font-weight:700; margin:8mm 0 2mm; font-size:14px;
  }

  /* 備考（印刷時はテンプレ文を出さない運用＝空欄） */
  .notes{
    min-height:24mm; border:1px solid var(--line); padding:6px 8px; font-size:12.5px;
  }

  /* 操作用UI（印刷時は非表示） */
  .controls{
    position:sticky; top:0; background:#fff; border-bottom:1px solid #eee;
    padding:10px 12px; display:flex; gap:8px; align-items:center; z-index:5;
  }
  .controls button{
    font:inherit; padding:8px 12px; border:1px solid #ccc; background:#fff; cursor:pointer;
  }
  .controls .pill{
    border-radius:999px; padding:6px 12px; font-size:12.5px;
    background:#f6f6f6; border:1px solid #e5e5e5;
  }
  .grid-2{display:grid; grid-template-columns:1fr 1fr; gap:6px;}
  input[type="text"], input[type="number"]{
    width:100%; font:inherit; padding:6px 8px; border:1px solid #ccc; background:#fff;
  }
  input[type="number"]{text-align:right;}

  /* 印刷設定 */
  @page{ size:A4; margin:12mm; }
  @media print{
    .controls{display:none !important;}
    body{background:#fff;}
    .sheet{padding:0; width:auto; min-height:auto;}
    input, .pill, button{appearance:none; border:none; padding:0; margin:0;}
    input{outline:none;}
    .logo, .qr{border-color:#bbb;}
  }
</style>
</head>
<body>

<!-- 画面用コントロール（印刷時は非表示） -->
<div class="controls" role="toolbar" aria-label="操作">
  <button onclick="window.print()">🖨 印刷</button>
  <span class="pill">標準取付工事 台数：
    <button onclick="chgStd(-1)">－</button>
    <strong id="stdCount" style="display:inline-block; min-width:2ch; text-align:center;">1</strong>
    <button onclick="chgStd(1)">＋</button>
  </span>
  <span class="pill">合計（税込）：<strong id="grandTotal">¥0</strong></span>
</div>

<div class="sheet">

  <header>
    <!-- 左：宛名 -->
    <section class="to-block">
      <div class="to-label">お客様</div>
      <div>
        <div class="to-address">
          <input id="toAddress" type="text" placeholder="〒 住所を入力" />
        </div>
        <div class="to-name-line">
          <input id="toName" class="to-name" type="text" placeholder="お名前" />
          <span class="sama">様</span>
        </div>
        <div class="to-tel">
          TEL：<input id="toTel" type="text" placeholder="お電話番号" style="width:50%;" />
        </div>
      </div>
    </section>

    <!-- 右：会社情報（ロゴ上／QR下／右寄せ） -->
    <section class="from-block">
      <div class="logo" id="logoBox">LOGO</div>
      <div class="company">
株式会社ピアレキタガワ
長浜市曽根町350
TEL：<span contenteditable="true">000-000-0000</span>
MAIL：<span contenteditable="true">info@example.com</span>
      </div>
      <div class="qr" id="qrBox">LINE QR</div>
    </section>
  </header>

  <div class="title">お見積書</div>

  <!-- 見積明細 -->
  <div class="section-title">見積明細（エアコン本体 ほか）</div>
  <table id="itemsTable" aria-label="見積明細">
    <thead>
      <tr>
        <th style="width:42%;">品名・型番</th>
        <th style="width:10%;">数量<span class="unit-badge">（台）</span></th>
        <th style="width:16%;">単価（税込）</th>
        <th style="width:16%;">金額（税込）</th>
        <th style="width:16%;">備考</th>
      </tr>
    </thead>
    <tbody>
      <!-- 初期空行を5行用意（必要に応じて行追加はキーボード入力でOK） -->
      <tr>
        <td><input type="text" placeholder="例）ルームエアコン CS-XXXX" oninput="recalc()"></td>
        <td class="center"><input type="number" min="0" step="1" value="0" oninput="recalc()"></td>
        <td class="right"><input type="number" min="0" step="100" value="0" oninput="recalc()"></td>
        <td class="right"><span class="rowTotal">¥0</span></td>
        <td><input type="text" placeholder=""></td>
      </tr>
      <tr>
        <td><input type="text" oninput="recalc()"></td>
        <td class="center"><input type="number" min="0" step="1" value="0" oninput="recalc()"></td>
        <td class="right"><input type="number" min="0" step="100" value="0" oninput="recalc()"></td>
        <td class="right"><span class="rowTotal">¥0</span></td>
        <td><input type="text"></td>
      </tr>
      <tr>
        <td><input type="text" oninput="recalc()"></td>
        <td class="center"><input type="number" min="0" step="1" value="0" oninput="recalc()"></td>
        <td class="right"><input type="number" min="0" step="100" value="0" oninput="recalc()"></td>
        <td class="right"><span class="rowTotal">¥0</span></td>
        <td><input type="text"></td>
      </tr>
      <tr>
        <td><input type="text" oninput="recalc()"></td>
        <td class="center"><input type="number" min="0" step="1" value="0" oninput="recalc()"></td>
        <td class="right"><input type="number" min="0" step="100" value="0" oninput="recalc()"></td>
        <td class="right"><span class="rowTotal">¥0</span></td>
        <td><input type="text"></td>
      </tr>
      <tr>
        <td><input type="text" oninput="recalc()"></td>
        <td class="center"><input type="number" min="0" step="1" value="0" oninput="recalc()"></td>
        <td class="right"><input type="number" min="0" step="100" value="0" oninput="recalc()"></td>
        <td class="right"><span class="rowTotal">¥0</span></td>
        <td><input type="text"></td>
      </tr>
    </tbody>
  </table>

  <!-- 標準取付工事費（22,000円／台・税込｜台数は増やせる） -->
  <div class="section-title">標準取付工事費</div>
  <table aria-label="標準取付工事費">
    <thead>
      <tr>
        <th>内容</th>
        <th style="width:10%;">台数<span class="unit-badge">（台）</span></th>
        <th style="width:16%;">単価（税込）</th>
        <th style="width:16%;">金額（税込）</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>標準取付工事費</td>
        <td class="center"><input id="stdQty" type="number" min="0" step="1" value="1" oninput="recalc()"></td>
        <td class="right">¥<span id="stdUnit">22,000</span></td>
        <td class="right">¥<span id="stdTotal">22,000</span></td>
      </tr>
    </tbody>
  </table>

  <!-- 追加工事（今回は空欄保持。社長合流後に実装） -->
  <div class="section-title">追加工事（社長確認後に追加）</div>
  <table aria-label="追加工事">
    <thead>
      <tr>
        <th>項目</th>
        <th style="width:10%;">数量</th>
        <th style="width:16%;">単価（税込）</th>
        <th style="width:16%;">金額（税込）</th>
        <th style="width:16%;">備考</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td colspan="5" style="color:var(--muted); text-align:center; padding:10mm 0;">
          （後日、社長の指示で項目を追加します）
        </td>
      </tr>
    </tbody>
  </table>

  <!-- 小計・合計 -->
  <div class="section-title">合計</div>
  <table aria-label="合計">
    <tbody>
      <tr>
        <th style="width:68%;">小計（税込）</th>
        <td class="right" style="width:32%;">¥<span id="subTotal">0</span></td>
      </tr>
      <tr>
        <th>合計（税込）</th>
        <td class="right"><strong style="font-size:15px;">¥<span id="grandTotalBottom">0</span></strong></td>
      </tr>
    </tbody>
  </table>

  <!-- 備考（テンプレは印刷しない＝空欄で運用） -->
  <div class="section-title">備考</div>
  <div class="notes" id="notes" contenteditable="true" aria-label="備考メモ（空欄印刷）"></div>

</div>

<script>
  /* 金額フォーマッタ */
  const fmt = (n)=> n.toLocaleString('ja-JP');

  function recalc(){
    let itemsTable = document.getElementById('itemsTable').tBodies[0];
    let sub = 0;

    for(let r of itemsTable.rows){
      const qty = Number(r.cells[1].querySelector('input').value || 0);
      const price = Number(r.cells[2].querySelector('input').value || 0);
      // 単位は台固定（表記のみ）。計算は qty * price
      const rowTotal = qty * price;
      r.cells[3].querySelector('.rowTotal').textContent = '¥' + fmt(rowTotal);
      sub += rowTotal;
    }

    // 標準取付工事
    const unit = 22000; // 税込固定
    const q = Math.max(0, Number(document.getElementById('stdQty').value || 0));
    const stdTotal = unit * q;
    document.getElementById('stdUnit').textContent = fmt(unit);
    document.getElementById('stdTotal').textContent = fmt(stdTotal);

    // 小計＝明細合計＋標準工事
    const subtotal = sub + stdTotal;
    document.getElementById('subTotal').textContent = fmt(subtotal);

    // 合計（税込）＝小計（今回は税込運用。消費税別計算は不要）
    document.getElementById('grandTotal').textContent = '¥' + fmt(subtotal);
    document.getElementById('grandTotalBottom').textContent = fmt(subtotal);
  }

  function chgStd(delta){
    const el = document.getElementById('stdQty');
    let v = Number(el.value || 0) + delta;
    if(v < 0) v = 0;
    el.value = v;
    document.getElementById('stdCount').textContent = v;
    recalc();
  }

  // 初期化
  window.addEventListener('DOMContentLoaded', ()=>{
    recalc();
    // 台数表示（上部コントロールと同期）
    document.getElementById('stdCount').textContent = document.getElementById('stdQty').value;
  });

  // 氏名入力欄に合わせて「様」をすぐ右隣に固定表示（CSSで対応済／JS不要）
</script>

</body>
</html>
