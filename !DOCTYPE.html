<index html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>ãŠè¦‹ç©æ›¸ï¼ˆBä»•ä¸Šã’ãƒ»å°åˆ·ã¯é¡Œåã‹ã‚‰ï¼‰ v7.3.1R PrintPro</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root{
    --fg:#111; --muted:#666; --line:#e7e7ea;
    --accent:#0f766e; --bg:#f9fafb; --radius:16px;
    --shade:#f3f4f6; /* åˆè¨ˆã®ç¶²æ›ã‘ */
  }
  *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
  html,body{margin:0;padding:0;font-family:"BIZ UDPGothic",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Hiragino Sans","Hiragino Kaku Gothic ProN",Meiryo,"Noto Sans JP",sans-serif;color:var(--fg);background:var(--bg);}
  body{font-size:16px;line-height:1.6;touch-action:manipulation}
  input,button,select,textarea{font-size:16px;min-height:44px}

  header.appbar{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--line);padding:12px 14px;display:flex;gap:10px;align-items:center;z-index:5}
  header.appbar h1{font-size:18px;margin:0;flex:1}
  header.appbar .actions{display:flex;gap:10px;flex-wrap:wrap}
  header.appbar .actions button{padding:12px 16px;border:1px solid var(--line);background:#fff;border-radius:12px}
  header.appbar .actions button.primary{background:var(--accent);color:#fff;border-color:var(--accent)}

  .container{max-width:1100px;margin:16px auto;padding:0 16px 140px}
  .card{background:#fff;border:1px solid var(--line);border-radius:var(--radius);padding:14px;margin-bottom:14px;box-shadow:0 2px 0 rgba(0,0,0,.02);}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media (max-width:820px){.row{grid-template-columns:1fr}}

  label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
  input[type="text"], input[type="tel"], input[type="number"], textarea{width:100%;padding:12px;border:1px solid var(--line);border-radius:12px;font-size:16px;background:#fff}
  textarea{min-height:88px;resize:vertical}
  input[type="number"]::-webkit-outer-spin-button, input[type="number"]::-webkit-inner-spin_button{-webkit-appearance:none;margin:0}

  table{width:100%;border-collapse:separate;border-spacing:0 0}
  th,td{border-bottom:1px solid var(--line);padding:10px 8px;text-align:left;font-size:16px;vertical-align:top}
  th{background:#fafafa;font-weight:700}
  button.icon{border:1px solid var(--line);background:#fff;border-radius:12px;padding:10px 14px}
  .num{text-align:right}
  .notes-cell input{width:100%}
  .print-only{display:none}

  .grand-wrap{display:flex;justify-content:flex-end;margin-top:12px}
  .grand-wrap table{width:auto;min-width:360px}
  .grand-wrap th, .grand-wrap td{padding:12px;border:none;border-bottom:1px solid var(--line)}
  .grand{font-weight:700;font-size:18px}

  .sheet{background:#fff;border:1px solid var(--line);border-radius:var(--radius);padding:22px}
  .sheet h2{margin:0 0 12px 0;font-size:24px;border-bottom:2px solid #000;display:inline-block;padding-right:8px}

  /* ä¼šç¤¾æƒ…å ±ï¼ˆç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¯å¾“æ¥ã©ãŠã‚Šï¼‰ */
  .company-info{text-align:left}
  .brand-block{display:inline-block;text-align:left}
  .company-info .logo{height:auto;object-fit:contain;display:block;margin:0 0 8px 0}
  .company-contacts{line-height:1.7;font-size:14px}
  #brandName{display:inline-block;font-size:16px;line-height:1.7;font-weight:700}

  .company-line{margin-top:10px;display:flex;flex-direction:column;align-items:flex-end;gap:8px}
  .line-row{display:flex;gap:12px;align-items:center;justify-content:flex-end;width:100%}
  .line-row .icon{width:120px;height:120px;object-fit:contain}
  .line-row .qr{width:120px;height:120px;object-fit:contain}
  .line-note{font-size:14px;color:#000;text-align:right;width:100%}

  /* å®›åï¼ˆç”»é¢ã®ã¿è¡¨ç¤ºï¼‰ */
  .header-flex{display:flex;justify-content:space-between;align-items:flex-start;margin-top:8px}
  .dest .name{font-weight:700}

  /* ====== å°åˆ·ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆBå¯„ã‚Šãƒ»1æšåã‚ï¼‰ ====== */
  @media print {
    @page { size: A4; margin: 14mm 14mm; } /* ä½™ç™½ã‚’ã‚„ã‚„è©°ã‚ã¦1æšåã‚ */
    body{background:#fff; font-size:11pt; line-height:1.45; color:#000; }
    header.appbar, .no-print{display:none !important}
    .container{padding:0;margin:0;max-width:100%}
    .card{border:none;box-shadow:none;margin:0;padding:0}

    /* é¡Œåã‚ˆã‚Šä¸Šã¯éè¡¨ç¤ºï¼ˆå…¥åŠ›ã‚«ãƒ¼ãƒ‰ãªã©ï¼‰ */
    .row, .header-flex{display:none !important}

    /* ã‚¿ã‚¤ãƒˆãƒ« */
    .sheet{padding:0}
    .sheet h2{font-size:18pt; border-bottom:2pt solid #000; padding-bottom:2pt; margin:0 0 8pt 0}

    /* å®›åãƒ–ãƒ­ãƒƒã‚¯ï¼ˆå°åˆ·è¡¨ç¤ºç”¨ï¼‰ */
    .dest-print{display:block; margin:10pt 0 6pt 0; page-break-inside:avoid;}
    .dest-print .addr{font-size:10.5pt;}
    .dest-print .name{font-size:13pt; font-weight:700;} /* å¤§ããå¤ªå­— */
    .dest-print .tel, .dest-print .date{font-size:9.5pt; color:#111;}

    /* ä¼šç¤¾æƒ…å ±ã¯å³å¯„ã›ï¼ˆãƒ­ã‚´ã‚‚å³ï¼‰ */
    .company-print-grid{
      display:grid; grid-template-columns:1fr auto; align-items:start; gap:8pt; margin-top:0
    }
    .company-info{ text-align:right; }
    .brand-block{ text-align:right; }
    .company-info .logo{ margin:0 0 6pt auto; max-height:28mm; } /* å³å¯„ã› */
    .company-contacts{font-size:10pt; line-height:1.6; }
    #brandName{font-size:12pt; font-weight:700;} /* ä½æ‰€ã‚ˆã‚Šå¤§ãã */

    /* LINEç”»åƒã‚µã‚¤ã‚ºï¼ˆå°åˆ·ï¼‰ */
    .line-row .icon, .line-row .qr{width:90px; height:90px}

    /* è¡¨ï¼šå®Ÿç·š+ãƒ˜ãƒƒãƒ€ãƒ¼ç¹°è¿”ã—+è¡Œåˆ†å‰²å›é¿ */
    table{border-collapse:collapse; border-spacing:0}
    thead{display:table-header-group}
    tfoot{display:table-footer-group}
    th, td{
      border:1pt solid #000 !important;
      padding:6pt 5pt !important;
      background:#fff !important;
      -webkit-print-color-adjust:exact; print-color-adjust:exact;
      page-break-inside:avoid;
    }
    th{font-weight:700}
    tr{page-break-inside:avoid}

    /* å…¥åŠ›ãƒœãƒƒã‚¯ã‚¹ã¯â€œæ–‡å­—ã ã‘â€ã«è¦‹ã›ã‚‹ */
    input, textarea, select{
      border:none !important; outline:none !important; box-shadow:none !important;
      background:transparent !important; padding:0 !important; margin:0 !important;
      -webkit-appearance:none; appearance:none;
    }
    td input[type="number"], td input[type="text"]{
      width:auto !important; min-width:0 !important;
    }

    /* Bå¯„ã‚Šè¦–ç·šèª˜å°ï¼šåˆè¨ˆã‚’ç¶²æ›ã‘ï¼†å¼·èª¿ */
    .grand-wrap table tr.grand th, .grand-wrap table tr.grand td{
      background:var(--shade) !important; font-weight:700; border-top:2pt solid #000
    }
    .grand{font-size:13pt}

    /* ç©ºã®è¿½åŠ å·¥äº‹ã¯éè¡¨ç¤º */
    #extras:has(tbody:empty){display:none}
    #extrasHead:has(+ #extras tbody:empty){display:none}
  }
</style>
</head>
<body>

<header class="appbar no-print">
  <h1>ãŠè¦‹ç©æ›¸ï¼ˆBä»•ä¸Šã’ãƒ»å°åˆ·ã¯é¡Œåã‹ã‚‰ï¼‰ v7.3.1R PrintPro</h1>
  <div class="actions">
    <button class="icon" onclick="addItem()">+æ˜ç´°è¡Œ</button>
    <button class="primary" onclick="window.print()">å°åˆ·</button>
  </div>
</header>

<div class="container">
  <!-- å…¥åŠ›ã‚«ãƒ¼ãƒ‰ï¼ˆå°åˆ·éè¡¨ç¤ºï¼‰ -->
  <div class="card">
    <div class="row">
      <div>
        <label>ãŠå®¢æ§˜ã®ã”ä½æ‰€</label>
        <input id="inAddr" type="text" placeholder="ä¾‹ï¼‰ã€’526-0102 æ»‹è³€çœŒé•·æµœå¸‚æ›½æ ¹ç”º..." inputmode="text" />
      </div>
      <div>
        <label>ãŠå®¢æ§˜ã®ãŠåå‰</label>
        <input id="inName" type="text" placeholder="ä¾‹ï¼‰åŒ—å´ ãƒ’ãƒˆãƒŸ" inputmode="text" />
      </div>
      <div>
        <label>ãŠå®¢æ§˜ã®é›»è©±ç•ªå·</label>
        <input id="inTel" type="tel" placeholder="ä¾‹ï¼‰0749-72-2406" inputmode="tel" />
      </div>
      <div>
        <label>æœ‰åŠ¹æœŸé™ / è¦‹ç©æ—¥ï¼ˆä»»æ„ï¼‰</label>
        <input id="inDate" type="text" placeholder="ä¾‹ï¼‰2025å¹´10æœˆ25æ—¥ã¾ã§æœ‰åŠ¹" inputmode="text" />
      </div>
    </div>
  </div>

  <div class="card sheet" id="printArea">
    <h2>ãŠè¦‹ç©æ›¸</h2>

    <!-- å®›åãƒ–ãƒ­ãƒƒã‚¯ï¼ˆå°åˆ·å°‚ç”¨ãƒ»å·¦ï¼‰ -->
    <div id="destPrint" class="dest-print" style="display:none">
      <div id="pAddr" class="addr"></div>
      <div class="name"><span id="pName"></span></div>
      <div id="pTel" class="tel"></div>
      <div id="pDate" class="date"></div>
    </div>

    <!-- ä¼šç¤¾æƒ…å ±ï¼ˆå³å¯„ã›ï¼‰ï¼LINE -->
    <div class="company-print-grid">
      <div></div> <!-- å·¦å´ã¯ç©ºï¼ˆå®›åãŒå…¥ã‚‹æƒ³å®šï¼‰ -->
      <div class="company-info">
        <div class="brand-block">
          <img class="logo" id="companyLogo" src="data:image/png;base64,{{COMPANY_LOGO_BASE64}}" alt="æ ªå¼ä¼šç¤¾ãƒ”ã‚¢ãƒ¬ã‚­ã‚¿ã‚¬ãƒ¯ ãƒ­ã‚´">
          <div id="brandName">æ ªå¼ä¼šç¤¾ãƒ”ã‚¢ãƒ¬ã‚­ã‚¿ã‚¬ãƒ¯</div>
          <div class="company-contacts">
            <div>ã€’526-0102 æ»‹è³€çœŒé•·æµœå¸‚æ›½æ ¹ç”º350</div>
            <div>TELï¼š0749-72-2406</div>
          </div>
        </div>
        <div class="company-line">
          <div class="line-row">
            <img class="icon" id="lineIcon" src="data:image/png;base64,{{LINE_ICON_BASE64}}" alt="LINEãƒ­ã‚´">
            <img class="qr" id="lineQr" src="data:image/png;base64,{{LINE_QR_BASE64}}" alt="LINEå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆQR">
          </div>
          <div class="line-note">LINEã‹ã‚‰ã‚‚ãŠæ°—è»½ã«ã”é€£çµ¡ãã ã•ã„</div>
        </div>
      </div>
    </div>

    <!-- ç”»é¢ç”¨ã®å®›åï¼ˆå¾“æ¥ã©ãŠã‚Šè¡¨ç¤ºï¼‰ -->
    <div class="header-flex no-print">
      <div class="dest">
        <div id="destAddress" style="font-size:12pt;"></div>
        <div class="name"><span id="destName"></span><span> æ§˜</span></div>
        <div id="destTel" style="font-size:10pt;"></div>
        <div id="destDate" class="muted" style="font-size:9pt;"></div>
      </div>
    </div>

    <!-- æ˜ç´° -->
    <div class="section-head" style="display:flex;align-items:center;gap:10px;margin:14px 0 6px">
      <div class="section-title">è¦‹ç©æ˜ç´°ï¼ˆã‚¨ã‚¢ã‚³ãƒ³æœ¬ä½“ãªã©ï¼‰</div>
      <button class="icon no-print" onclick="addItem()">+ æ˜ç´°è¡Œã‚’è¿½åŠ </button>
    </div>
    <table id="items">
      <thead>
        <tr>
          <th style="width:36%">å“åãƒ»å‹ç•ª</th>
          <th style="width:10%">æ•°é‡ï¼ˆå°ï¼‰</th>
          <th style="width:18%">å˜ä¾¡ï¼ˆç¨è¾¼ï¼‰</th>
          <th style="width:16%">å°è¨ˆï¼ˆç¨è¾¼ï¼‰</th>
          <th style="width:20%">å‚™è€ƒ</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <!-- æ¨™æº–å–ä»˜å·¥äº‹è²» -->
    <div class="section-head" style="display:flex;align-items:center;gap:10px;margin:14px 0 6px">
      <div class="section-title">æ¨™æº–å–ä»˜å·¥äº‹è²» <span class="muted">ï¼ˆ1å° 22,000å†† ç¨è¾¼å›ºå®šï¼‰</span></div>
    </div>
    <table id="install">
      <thead>
        <tr>
          <th>å†…å®¹</th>
          <th style="width:12%">å°æ•°</th>
          <th style="width:18%">å˜ä¾¡ï¼ˆç¨è¾¼ï¼‰</th>
          <th style="width:18%">å°è¨ˆï¼ˆç¨è¾¼ï¼‰</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>æ¨™æº–å–ä»˜å·¥äº‹</td>
          <td><input type="number" min="0" step="1" value="1" oninput="recalc()" inputmode="numeric" /></td>
          <td class="num">
            <span class="print-hide">22,000</span>
            <span class="print-only">22,000</span>
          </td>
          <td class="num subtotal">22,000</td>
        </tr>
      </tbody>
    </table>

    <!-- è¿½åŠ å·¥äº‹ -->
    <div id="extrasHead" class="section-head" style="display:flex;align-items:center;gap:10px;margin:14px 0 6px">
      <div class="section-title">è¿½åŠ å·¥äº‹</div>
      <button class="icon no-print" onclick="openAddWorks()">ğŸ§° è¿½åŠ å·¥äº‹ã‚’é¸ã¶</button>
    </div>
    <table id="extras">
      <thead>
        <tr>
          <th style="width:42%">å†…å®¹</th>
          <th style="width:10%">æ•°é‡</th>
          <th style="width:8%">å˜ä½</th>
          <th style="width:18%">å˜ä¾¡ï¼ˆç¨è¾¼ï¼‰</th>
          <th style="width:14%">å°è¨ˆï¼ˆç¨è¾¼ï¼‰</th>
          <th style="width:8%">å‚™è€ƒ</th>
        </tr>
      </thead>
      <tbody>
        <!-- ç©ºï¼ˆé¸ã¶ã¾ã§è¡¨ç¤ºãªã—ï¼‰ -->
      </tbody>
    </table>

    <!-- åˆè¨ˆï¼ˆç¨è¾¼ï¼‰ã®ã¿ -->
    <div class="grand-wrap">
      <table>
        <tr class="grand"><th>åˆè¨ˆ <span class="muted">ï¼ˆç¨è¾¼ï¼‰</span></th><td id="sumGross" class="num">0</td></tr>
      </table>
    </div>

  </div>

  <!-- è¿½åŠ å·¥äº‹ã®é¸æŠï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰ -->
  <div id="worksModal" class="no-print" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.35);padding:20px;z-index:50;">
    <div style="width:min(94vw,760px);max-height:80vh;overflow:auto;margin:6vh auto;background:#fff;border-radius:16px;border:1px solid var(--line);padding:16px">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px">
        <strong style="font-size:18px">è¿½åŠ å·¥äº‹ã‚’é¸ã¶</strong>
        <button class="icon" onclick="closeAddWorks()">é–‰ã˜ã‚‹</button>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
        <button class="icon" onclick="addExtra('é…ç®¡å»¶é•·', 3000, 'm')">é…ç®¡å»¶é•·ï¼ˆ1m 3,000ï¼‰</button>
        <button class="icon" onclick="addExtra('ç©´ã‚ã‘å·¥äº‹ï¼ˆåŸºç¤RCä»¥å¤–ï¼‰', 6600, 'ã‹æ‰€')">ç©´ã‚ã‘å·¥äº‹ï¼ˆ1ã‹æ‰€ 6,600ï¼‰</button>
        <button class="icon" onclick="addExtra('ã‚¨ã‚¢ã‚³ãƒ³å‡¦ç†è²»ï¼ˆè²·ã„æ›¿ãˆæ™‚ï¼‰', 3190, 'å°')">ã‚¨ã‚¢ã‚³ãƒ³å‡¦ç†è²»ï¼ˆ1å° 3,190ï¼‰</button>
      </div>
    </div>
  </div>

</div>

<script>
function yen(n){return (Math.round(n)||0).toLocaleString('ja-JP')}
function parseNum(v){return parseFloat((v||'').toString().replace(/,/g,''))||0}

function addItem(name='', qty=1, unitPrice=0, note=''){
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td><input type="text" placeholder="å“åãƒ»å‹ç•ª" value="${name}" inputmode="text"></td>
    <td><input type="number" min="0" step="1" value="${qty}" oninput="recalc()" inputmode="numeric"></td>
    <td class="num">
      <input class="print-hide" type="number" min="0" step="1" value="${unitPrice}" oninput="recalc()" inputmode="numeric">
      <span class="print-only price-view"></span>
    </td>
    <td class="num subtotal">0</td>
    <td class="notes-cell"><input type="text" placeholder="å‚™è€ƒï¼ˆä»»æ„ï¼‰" value="${note}"></td>
  `;
  document.querySelector('#items tbody').appendChild(tr);
  recalc();
}

function addExtra(label, unitPrice, unit, note=''){
  const tbody = document.querySelector('#extras tbody');
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td>${label}</td>
    <td><input type="number" min="0" step="1" value="1" oninput="recalc()" inputmode="numeric"></td>
    <td class="muted">${unit}</td>
    <td class="num">
      <input class="print-hide" type="number" min="0" step="1" value="${unitPrice}" oninput="recalc()" inputmode="numeric">
      <span class="print-only price-view"></span>
    </td>
    <td class="num subtotal">0</td>
    <td class="notes-cell"><input type="text" placeholder="å‚™è€ƒï¼ˆä»»æ„ï¼‰" value="${note}"></td>
  `;
  tbody.appendChild(tr);
  recalc();
}

function recalc(){
  let total = 0;

  // æ˜ç´°
  document.querySelectorAll('#items tbody tr').forEach(tr=>{
    const qty = parseNum(tr.querySelector('td:nth-child(2) input').value);
    const priceInput = tr.querySelector('td:nth-child(3) input');
    const unit = parseNum(priceInput.value);
    const sub = qty * unit;
    tr.querySelector('.subtotal').textContent = yen(sub);
    const pv = tr.querySelector('.price-view');
    if(pv) pv.textContent = yen(unit);
    total += sub;
  });

  // æ¨™æº–å–ä»˜å·¥äº‹
  const instRow = document.querySelector('#install tbody tr');
  if(instRow){
    const qty = parseNum(instRow.querySelector('td:nth-child(2) input').value);
    const unit = 22000;
    const sub = qty * unit;
    instRow.querySelector('.subtotal').textContent = yen(sub);
    total += sub;
  }

  // è¿½åŠ å·¥äº‹
  document.querySelectorAll('#extras tbody tr').forEach(tr=>{
    const qty = parseNum(tr.querySelector('td:nth-child(2) input').value);
    const priceInput = tr.querySelector('td:nth-child(4) input');
    const unit = parseNum(priceInput.value);
    const sub = qty * unit;
    tr.querySelector('.subtotal').textContent = yen(sub);
    const pv = tr.querySelector('.price-view');
    if(pv) pv.textContent = yen(unit);
    total += sub;
  });

  document.getElementById('sumGross').textContent = yen(total);

  // ç”»é¢ã®å®›åè¡¨ç¤ºã‚’åŒæœŸ
  syncDestDisplay();
}

// å®›åã®è¡¨ç¤ºï¼ˆç”»é¢ï¼†å°åˆ·ï¼‰ã‚’åŒæœŸ
function syncDestDisplay(){
  const addr = document.getElementById('inAddr').value.trim();
  const name = document.getElementById('inName').value.trim();
  const tel  = document.getElementById('inTel').value.trim();
  const date = document.getElementById('inDate').value.trim();

  // ç”»é¢ç”¨ï¼ˆå¾“æ¥ï¼‰
  document.getElementById('destAddress').textContent = addr || '';
  document.getElementById('destName').textContent = name || '';
  document.getElementById('destTel').textContent = tel || '';
  document.getElementById('destDate').textContent = date || '';

  // å°åˆ·ç”¨ï¼ˆæ°åã¯ã€Œæ§˜ã€è‡ªå‹•ä»˜ä¸ï¼‰
  const dp = document.getElementById('destPrint');
  const hasAny = addr || name || tel || date;
  dp.style.display = hasAny ? 'block' : 'none';
  document.getElementById('pAddr').textContent = addr || '';
  document.getElementById('pName').textContent = name ? (name + ' æ§˜') : '';
  document.getElementById('pTel').textContent  = tel  || '';
  document.getElementById('pDate').textContent = date || '';
}

// å…¥åŠ›ã«åå¿œã—ã¦å®›åã‚’å³æ™‚åŒæœŸ
['inAddr','inName','inTel','inDate'].forEach(id=>{
  const el = document.getElementById(id);
  el.addEventListener('input', syncDestDisplay);
});

// åˆæœŸ1è¡Œ
addItem('', 1, 0, '');
recalc();
syncDestDisplay();

function openAddWorks(){document.getElementById('worksModal').style.display='block'}
function closeAddWorks(){document.getElementById('worksModal').style.display='none'}

/* å°åˆ·ç›´å‰ï¼šå˜ä¾¡ã®ä¼šè¨ˆè¡¨ç¤ºï¼†å®›ååŒæœŸã‚’å¿µæŠ¼ã—æ›´æ–° */
function beforePrintTidy(){
  recalc();
  syncDestDisplay();
}
if('onbeforeprint' in window){
  window.addEventListener('beforeprint', beforePrintTidy);
} else {
  document.querySelectorAll('button[onclick="window.print()"]').forEach(btn=>{
    btn.addEventListener('click', beforePrintTidy, {capture:true});
  });
}
</script>

</body>
</html>

